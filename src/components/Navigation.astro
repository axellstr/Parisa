---
// Navigation component for header
import { Search, ShoppingCart, ChevronDown } from 'lucide-astro';

// Use direct path to public logo (required for Vercel deployment)
const logoDark = '/images/Logo_dark.svg';
---

<nav class="navigation">
  <div class="container">
    <div class="nav-content">
      <!-- Hamburger Menu -->
      <div class="nav-left">
        <button class="hamburger-btn" aria-label="Menu" id="hamburger-menu">
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
        </button>
      </div>
      
      <!-- Logo Center -->
      <div class="logo">
        <a href="/" class="brand-logo">
          <img src={logoDark} alt="Parisa" class="logo-image" width="120" height="40" loading="eager" />
        </a>
      </div>
      
      <!-- Cart Actions -->
      <div class="nav-actions">
        <button class="search-btn" aria-label="Search">
          <Search size={20} />
        </button>
        <button class="cart-btn" aria-label="Shopping Cart">
          <ShoppingCart size={20} />
          <span class="cart-count" data-cart-count style="display: none;">0</span>
        </button>
      </div>
    </div>
    
    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu" id="mobile-menu">
      <div class="mobile-menu-content">
        <div class="nav-item-with-dropdown">
          <button class="nav-dropdown-btn" data-dropdown="collections">
            <span class="nav-title-with-icon">
              Collections
              <ChevronDown size={16} class="dropdown-arrow" />
            </span>
          </button>
          <div class="dropdown-content" id="collections-dropdown">
            <!-- All Collections Link -->
            <a href="/collections" class="featured-link">All Collections</a>
            
            <!-- Individual Collections -->
            <a href="/collections/kaleidoscope">Kaleidoscope Collection</a>
            <a href="/collections/heritage">Heritage Collection</a>
            <a href="/collections/contemporary">Contemporary Collection</a>
            <a href="/collections/artisan">Artisan Collection</a>
            
            <!-- Category Dropdown -->
            <div class="nav-item-with-dropdown nested">
              <button class="nav-dropdown-btn nested" data-dropdown="necklaces">
                <span class="nav-title-with-icon">
                  By Category
                  <ChevronDown size={14} class="dropdown-arrow" />
                </span>
              </button>
              <div class="dropdown-content nested" id="necklaces-dropdown">
                <a href="/collections?filter=necklaces">Necklaces</a>
                <a href="/collections?filter=earrings">Earrings</a>
                <a href="/collections?filter=rings">Rings</a>
                <a href="/collections?filter=bracelets">Bracelets</a>
                <a href="/collections?filter=pendants">Pendants</a>
              </div>
            </div>
            
            <!-- Earrings Dropdown -->
            <div class="nav-item-with-dropdown nested">
              <button class="nav-dropdown-btn nested" data-dropdown="earrings">
                <span class="nav-title-with-icon">
                  Earrings
                  <ChevronDown size={14} class="dropdown-arrow" />
                </span>
              </button>
              <div class="dropdown-content nested" id="earrings-dropdown">
                <a href="#">Studs</a>
                <a href="#">Hoops</a>
                <a href="#">Dangles</a>
                <a href="#">Ear Climbers</a>
                <a href="#">Ear Cuffs</a>
              </div>
            </div>
            
            <!-- Bracelets Dropdown -->
            <div class="nav-item-with-dropdown nested">
              <button class="nav-dropdown-btn nested" data-dropdown="bracelets">
                <span class="nav-title-with-icon">
                  Bracelets
                  <ChevronDown size={14} class="dropdown-arrow" />
                </span>
              </button>
              <div class="dropdown-content nested" id="bracelets-dropdown">
                <a href="#">Bangles</a>
                <a href="#">Chain Bracelets</a>
                <a href="#">Cuffs</a>
                <a href="#">Tennis Bracelets</a>
                <a href="#">Charm Bracelets</a>
              </div>
            </div>
            
            <!-- Rings Dropdown -->
            <div class="nav-item-with-dropdown nested">
              <button class="nav-dropdown-btn nested" data-dropdown="rings">
                <span class="nav-title-with-icon">
                  Rings
                  <ChevronDown size={14} class="dropdown-arrow" />
                </span>
              </button>
              <div class="dropdown-content nested" id="rings-dropdown">
                <a href="#">Statement Rings</a>
                <a href="#">Bands</a>
                <a href="#">Stackable Rings</a>
                <a href="#">Cocktail Rings</a>
                <a href="#">Midi Rings</a>
              </div>
            </div>
            
            <!-- Jewelry Sets Dropdown -->
            <div class="nav-item-with-dropdown nested">
              <button class="nav-dropdown-btn nested" data-dropdown="sets">
                <span class="nav-title-with-icon">
                  Jewelry Sets
                  <ChevronDown size={14} class="dropdown-arrow" />
                </span>
              </button>
              <div class="dropdown-content nested" id="sets-dropdown">
                <a href="#">Bridal Sets</a>
                <a href="#">Matching Sets</a>
                <a href="#">Gift Sets</a>
                <a href="#">Travel Sets</a>
              </div>
            </div>
            
            <!-- New Arrivals -->
            <a href="#" class="main-collection-link">New Arrivals</a>
          </div>
        </div>
        <a href="#">About</a>
        <a href="#">Contact</a>
        <a href="#">Shipping</a>
        <a href="#">Returns</a>
      </div>
    </div>
  </div>
</nav>

<script>
  // Mobile menu toggle
  const hamburger = document.getElementById('hamburger-menu');
  const mobileMenu = document.getElementById('mobile-menu');
  
  hamburger?.addEventListener('click', () => {
    hamburger.classList.toggle('active');
    mobileMenu?.classList.toggle('active');
  });

  // Dropdown functionality
  const dropdownBtns = document.querySelectorAll('.nav-dropdown-btn');
  
  dropdownBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      const dropdownId = btn.getAttribute('data-dropdown') + '-dropdown';
      const dropdownContent = document.getElementById(dropdownId);
      const isNested = btn.classList.contains('nested');
      
      // Toggle active class on button and dropdown
      btn.classList.toggle('active');
      dropdownContent?.classList.toggle('active');
      
      // For nested dropdowns, don't close parent dropdown
      if (!isNested) {
        // Close other main level dropdowns
        dropdownBtns.forEach(otherBtn => {
          if (otherBtn !== btn && !otherBtn.classList.contains('nested')) {
            otherBtn.classList.remove('active');
            const otherDropdownId = otherBtn.getAttribute('data-dropdown') + '-dropdown';
            const otherDropdown = document.getElementById(otherDropdownId);
            otherDropdown?.classList.remove('active');
          }
        });
      } else {
        // Close other nested dropdowns at the same level
        const parentDropdown = btn.closest('.dropdown-content');
        const siblingNestedBtns = parentDropdown?.querySelectorAll('.nav-dropdown-btn.nested');
        
        siblingNestedBtns?.forEach(otherBtn => {
          if (otherBtn !== btn) {
            otherBtn.classList.remove('active');
            const otherDropdownId = otherBtn.getAttribute('data-dropdown') + '-dropdown';
            const otherDropdown = document.getElementById(otherDropdownId);
            otherDropdown?.classList.remove('active');
          }
        });
      }
    });
  });

  // Cart functionality is loaded globally in Layout.astro
</script>

<style>
  @import "/src/styles/navigation.css";
</style>
