---
// Navigation component for header
import { Image } from 'astro:assets';
import { Search, ShoppingCart, ChevronDown } from 'lucide-astro';

// Import logo for optimization
import logoDark from '../../public/images/Logo_dark.svg';
---

<nav class="navigation">
  <div class="container">
    <div class="nav-content">
      <!-- Hamburger Menu -->
      <div class="nav-left">
        <button class="hamburger-btn" aria-label="Menu" id="hamburger-menu">
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
        </button>
      </div>
      
      <!-- Logo Center -->
      <div class="logo">
        <a href="/" class="brand-logo">
          <Image src={logoDark} alt="Parisa" class="logo-image" width={120} height={40} loading="eager" />
        </a>
      </div>
      
      <!-- Cart Actions -->
      <div class="nav-actions">
        <button class="search-btn" aria-label="Search">
          <Search size={20} />
        </button>
        <button class="cart-btn" aria-label="Shopping Cart">
          <ShoppingCart size={20} />
          <span class="cart-count" id="cart-count">0</span>
        </button>
      </div>
    </div>
    
    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu" id="mobile-menu">
      <div class="mobile-menu-content">
        <div class="nav-item-with-dropdown">
          <button class="nav-dropdown-btn" data-dropdown="collections">
            <span class="nav-title-with-icon">
              Collections
              <ChevronDown size={16} class="dropdown-arrow" />
            </span>
          </button>
          <div class="dropdown-content" id="collections-dropdown">
            <!-- Necklaces Dropdown -->
            <div class="nav-item-with-dropdown nested">
              <button class="nav-dropdown-btn nested" data-dropdown="necklaces">
                <span class="nav-title-with-icon">
                  Necklaces
                  <ChevronDown size={14} class="dropdown-arrow" />
                </span>
              </button>
              <div class="dropdown-content nested" id="necklaces-dropdown">
                <a href="/collections/necklaces/statement">Statement Necklaces</a>
                <a href="/collections/necklaces/chokers">Chokers</a>
                <a href="/collections/necklaces/pendants">Pendants</a>
                <a href="/collections/necklaces/chains">Chains</a>
                <a href="/collections/necklaces/layering">Layering Sets</a>
              </div>
            </div>
            
            <!-- Earrings Dropdown -->
            <div class="nav-item-with-dropdown nested">
              <button class="nav-dropdown-btn nested" data-dropdown="earrings">
                <span class="nav-title-with-icon">
                  Earrings
                  <ChevronDown size={14} class="dropdown-arrow" />
                </span>
              </button>
              <div class="dropdown-content nested" id="earrings-dropdown">
                <a href="/collections/earrings/studs">Studs</a>
                <a href="/collections/earrings/hoops">Hoops</a>
                <a href="/collections/earrings/dangles">Dangles</a>
                <a href="/collections/earrings/climbers">Ear Climbers</a>
                <a href="/collections/earrings/cuffs">Ear Cuffs</a>
              </div>
            </div>
            
            <!-- Bracelets Dropdown -->
            <div class="nav-item-with-dropdown nested">
              <button class="nav-dropdown-btn nested" data-dropdown="bracelets">
                <span class="nav-title-with-icon">
                  Bracelets
                  <ChevronDown size={14} class="dropdown-arrow" />
                </span>
              </button>
              <div class="dropdown-content nested" id="bracelets-dropdown">
                <a href="/collections/bracelets/bangles">Bangles</a>
                <a href="/collections/bracelets/chains">Chain Bracelets</a>
                <a href="/collections/bracelets/cuffs">Cuffs</a>
                <a href="/collections/bracelets/tennis">Tennis Bracelets</a>
                <a href="/collections/bracelets/charm">Charm Bracelets</a>
              </div>
            </div>
            
            <!-- Rings Dropdown -->
            <div class="nav-item-with-dropdown nested">
              <button class="nav-dropdown-btn nested" data-dropdown="rings">
                <span class="nav-title-with-icon">
                  Rings
                  <ChevronDown size={14} class="dropdown-arrow" />
                </span>
              </button>
              <div class="dropdown-content nested" id="rings-dropdown">
                <a href="/collections/rings/statement">Statement Rings</a>
                <a href="/collections/rings/bands">Bands</a>
                <a href="/collections/rings/stackable">Stackable Rings</a>
                <a href="/collections/rings/cocktail">Cocktail Rings</a>
                <a href="/collections/rings/midi">Midi Rings</a>
              </div>
            </div>
            
            <!-- Jewelry Sets Dropdown -->
            <div class="nav-item-with-dropdown nested">
              <button class="nav-dropdown-btn nested" data-dropdown="sets">
                <span class="nav-title-with-icon">
                  Jewelry Sets
                  <ChevronDown size={14} class="dropdown-arrow" />
                </span>
              </button>
              <div class="dropdown-content nested" id="sets-dropdown">
                <a href="/collections/sets/bridal">Bridal Sets</a>
                <a href="/collections/sets/matching">Matching Sets</a>
                <a href="/collections/sets/gift">Gift Sets</a>
                <a href="/collections/sets/travel">Travel Sets</a>
              </div>
            </div>
            
            <!-- New Arrivals -->
            <a href="/collections/new-arrivals" class="main-collection-link">New Arrivals</a>
          </div>
        </div>
        <a href="/about">About</a>
        <a href="/contact">Contact</a>
        <a href="/shipping">Shipping</a>
        <a href="/returns">Returns</a>
      </div>
    </div>
  </div>
</nav>

<script>
  // Mobile menu toggle
  const hamburger = document.getElementById('hamburger-menu');
  const mobileMenu = document.getElementById('mobile-menu');
  
  hamburger?.addEventListener('click', () => {
    hamburger.classList.toggle('active');
    mobileMenu?.classList.toggle('active');
  });

  // Dropdown functionality
  const dropdownBtns = document.querySelectorAll('.nav-dropdown-btn');
  
  dropdownBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      const dropdownId = btn.getAttribute('data-dropdown') + '-dropdown';
      const dropdownContent = document.getElementById(dropdownId);
      const isNested = btn.classList.contains('nested');
      
      // Toggle active class on button and dropdown
      btn.classList.toggle('active');
      dropdownContent?.classList.toggle('active');
      
      // For nested dropdowns, don't close parent dropdown
      if (!isNested) {
        // Close other main level dropdowns
        dropdownBtns.forEach(otherBtn => {
          if (otherBtn !== btn && !otherBtn.classList.contains('nested')) {
            otherBtn.classList.remove('active');
            const otherDropdownId = otherBtn.getAttribute('data-dropdown') + '-dropdown';
            const otherDropdown = document.getElementById(otherDropdownId);
            otherDropdown?.classList.remove('active');
          }
        });
      } else {
        // Close other nested dropdowns at the same level
        const parentDropdown = btn.closest('.dropdown-content');
        const siblingNestedBtns = parentDropdown?.querySelectorAll('.nav-dropdown-btn.nested');
        
        siblingNestedBtns?.forEach(otherBtn => {
          if (otherBtn !== btn) {
            otherBtn.classList.remove('active');
            const otherDropdownId = otherBtn.getAttribute('data-dropdown') + '-dropdown';
            const otherDropdown = document.getElementById(otherDropdownId);
            otherDropdown?.classList.remove('active');
          }
        });
      }
    });
  });
</script>

<style>
  @import "/src/styles/navigation.css";
</style>
